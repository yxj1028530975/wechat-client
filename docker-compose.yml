services:
  wechat-api:
    build: .
    container_name: wechat-api
    network_mode: host
    volumes:
      - wechat_images:/tmp/wechat_images
      - ./main.py:/app/main.py
    restart: unless-stopped
    environment:
      - TZ=Asia/Shanghai

  wechat-bridge:
    build: .
    container_name: wechat-bridge
    network_mode: host
    command: ["python", "bridge_wechat.py"]
    volumes:
      - ./bridge_wechat.py:/app/bridge_wechat.py
      - ./wechat_whitelist.txt:/app/wechat_whitelist.txt
      - /Users/yxj/.moltbot:/root/.moltbot:ro
    restart: unless-stopped
    environment:
      - TZ=Asia/Shanghai
      - WECHAT_WHITELIST_FILE=/app/wechat_whitelist.txt

volumes:
  wechat_images:
